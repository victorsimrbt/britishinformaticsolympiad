Seems like a relatively simple dynammic programming problem